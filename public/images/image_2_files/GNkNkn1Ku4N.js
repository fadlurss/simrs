if (self.CavalryLogger) { CavalryLogger.start_js(["OPIcD"]); }

__d("MInitJewelCounts",["Arbiter"],(function(a,b,c,d,e,f,g){"use strict";function a(a){g.inform("m:jewels:init-counts",a,"persistent")}e.exports={main:a}}),null);
__d("isNodeWithinRect",[],(function(a,b,c,d,e,f){function a(a,b){if(!a.getBoundingClientRect)return!1;a=a.getBoundingClientRect();return a.bottom>=b.top&&a.top<=b.bottom&&a.right>=b.left&&a.left<=b.right}e.exports=a}),null);
__d("MTabbable",["MAria","MJSEnvironment","MViewport","isNodeWithinRect"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();function k(a,b){while(a&&a!==b){if(g.isHidden(a))return!0;a=a.parentNode}return!1}function l(a,b){if(a.offsetHeight===0||a.offsetWidth===0||window.getComputedStyle(a).visibility==="hidden"||parseInt(a.tabIndex,10)<0||k(a,b))return!1;if(a.tabIndex>=0)return!0;switch(a.tagName){case"A":return a.href&&a.rel!="ignore";case"INPUT":return a.type!="hidden"&&a.type!="file"&&!a.disabled;case"BUTTON":case"SELECT":case"TEXTAREA":return!a.disabled}return!1}function a(a){__p&&__p();if(!a.getBoundingClientRect)return;var b=h.IS_APPLE_WEBKIT_IOS&&parseFloat(h.OS_VERSION)>=8||h.BROWSER_NAME==="Safari"&&!h.IS_APPLE_WEBKIT_IOS;b=b?a.querySelectorAll("a, button, select, [tabindex]"):a.querySelectorAll("a, button, input, select, textarea, [tabindex]");var c=i.getBoundingRect();for(var d=0,e;e=b[d];d++)if(l(e,a)&&j(e,c)){e.focus();return}}f.focusTabbable=a}),null);
__d("MHeaderGating",["CurrentUser","qex"],(function(a,b,c,d,e,f,g,h){"use strict";a={isStickyHeaderEnabled:function(){return g.isWorkUser()?!!h._("829069"):!!h._("817052")}};e.exports=a}),null);
__d("Popover",["CSS","DOM","MAria","MHeaderGating","MViewport","Stratcom","Vector","$","cx","eventsMixinDeprecated","nullthrows","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){__p&&__p();var s=40;a=function(){"use strict";__p&&__p();function a(b){__p&&__p();var c=b.flyout;c=typeof c==="string"?n(c):c;this.flyout=c;this.content=h.scry(this.flyout,"div","flyout-content")[0];this.content&&g.addClass(this.content,"_7i2z");this.options=b;this._onOrientationChange=this._reposition.bind(this);g.conditionClass(this.flyout,"popover_flyout",!0);c=b.button;c&&(c=typeof c==="string"?n(c):c,this.buttonClickListener=h.listen(c,"click",null,this._openHandler.bind(this)),c.setAttribute("role","button"),i.setupPopup(c,this.flyout),this.button=c);c=b.flyoutAnchor;c?this.flyoutAnchor=typeof c==="string"?n(c):c:this.flyoutAnchor=this.button;this.options.flyoutFromRoot&&(this.flyoutClickListener=h.listen(this.flyout,"click",null,this._openHandler.bind(this)));this.options.touchstart_callback&&(this.flyoutTouchStartListener=h.listen(this.flyout,"touchstart",null,this._touchStartHandler.bind(this)));this.options.touchmove_callback&&(this.flyoutTouchMoveListener=h.listen(this.flyout,"touchmove",null,this._touchMoveHandler.bind(this)));this.options.touchend_callback&&(this.flyoutTouchEndListener=h.listen(this.flyout,"touchend",null,this._touchEndHandler.bind(this)));a._instances[this.flyout.id]=this}var b=a.prototype;b.isOpen=function(){return!!this._isOpen};b.open=function(){__p&&__p();if(this.isOpen())return;a._activePopover&&a._activePopover.close();a._activePopover=this;this._isOpen=!0;this.constraint=null;g.conditionClass(this.flyout,"popover_hidden",!1);this.options.flyoutFromRoot&&this._absolutePositionFlyout();this._position();this.options.heightConstraint||(g.conditionClass(q(document.body),"disableClicks",!0),this.globalListener=l.listenCapture("click",null,this._closeHandler.bind(this)));window.addEventListener("orientationchange",this._onOrientationChange,!1);i.showPopup(this.button,this.flyout);if(this.options.ensureVisible){var b=k.getScrollTop(),c=this._getElementPosition(this.flyout).y,d=c+this.flyout.offsetHeight;d=d-(b+k.getUseableHeight());if(d>0){d=Math.min(d,Math.max(c-b-s,0));k.scrollTo(0,b+d)}}this.invoke("open")};b.close=function(b){__p&&__p();if(!this.isOpen())return;a._activePopover=null;this._isOpen=!1;g.conditionClass(this.flyout,"popover_hidden",!0);this.options.flyoutFromRoot&&this.flyoutParent&&(this.flyoutParent.appendChild(this.flyout),delete this.flyoutParent);r(function(){g.conditionClass(q(document.body),"disableClicks",!1)}.bind(this),400);this.globalListener&&this.globalListener.remove();window.removeEventListener("orientationchange",this._onOrientationChange,!1);this._releaseConstraint();i.hidePopup(this.button,this.flyout);b||this.invoke("close")};b.clear=function(){this.globalListener&&this.globalListener.remove(),this.buttonClickListener&&this.buttonClickListener.remove(),this.flyoutClickListener&&this.flyoutClickListener.remove(),this.flyoutTouchStartListener&&this.flyoutTouchStartListener.remove(),this.flyoutTouchMoveListener&&this.flyoutTouchMoveListener.remove(),this.flyoutTouchEndListener&&this.flyoutTouchEndListener.remove(),delete a._instances[this.flyout.id]};b.refreshConstraints=function(){__p&&__p();if(!this._isOpen)return!1;var b=this.flyout;this._releaseConstraint();if(this.options.heightConstraint){var c=j.isStickyHeaderEnabled();b.style.minHeight=k.getUseableHeight(c)+"px";this.constraint=k.addHeightConstraint(m.getDim(this.content).y+this._getElementPosition(b).y)}else this.constraint=k.addMinHeightConstraint(m.getDim(b).y+this._getElementPosition(b).y+a._MARGIN)};b._getTouchPoint=function(a){var b;a=a.getRawEvent();a instanceof TouchEvent&&(b=a.targetTouches[0]);a={x:b?b.screenX:0,y:b?b.screenY:0};return a};b._touchStartHandler=function(a){var b=this.options.touchstart_callback;b&&b(this._getTouchPoint(a))};b._touchMoveHandler=function(a){if(this.isOpen()){var b=this.options.touchmove_callback;b&&b(this._getTouchPoint(a))}};b._touchEndHandler=function(a){var b=this.options.touchend_callback;b&&b(this._getTouchPoint(a))};b._openHandler=function(a){__p&&__p();a.prevent();a=this.isOpen();if(a&&!this.options.preventClose)this.close();else if(!a){a=h.scry(document,"input");for(var b=0;b<a.length;b++)a[b].blur();this.open()}};b._closeHandler=function(a){a.getNode("popover")||this.close()};b._getElementPosition=function(a){__p&&__p();a=a;var b=a.offsetLeft,c=a.offsetTop;a=a.offsetParent;while(a&&a!==document.documentElement){b+=a.offsetLeft;c+=a.offsetTop;var d=window.getComputedStyle(a);b+=parseInt(d.getPropertyValue("border-left-width").slice(0,-2),10);c+=parseInt(d.getPropertyValue("border-top-width").slice(0,-2),10);a=a.offsetParent}return new m(b,c)};b._absolutePositionFlyout=function(){this.flyoutParent=this.flyout.parentNode;n("root").appendChild(this.flyout);var a=this._getElementPosition(this.flyout.parentNode),b=this._getElementPosition(this.flyoutAnchor),c=m.getDim(this.flyoutAnchor);b=b.y-a.y+c.y;this.flyout.style.position="absolute";this.flyout.style.top=b+"px"};b._position=function(){var a=this.flyout;if(this.flyoutAnchor&&this.options.positionNub){var b=this._getElementPosition(this.flyoutAnchor),c=h.find(this.flyout,"*","nub"),d=m.getDim(c).x,e=m.getDim(this.flyoutAnchor).x;a=this._getElementPosition(a);new m(b.x-a.x+(e-d)/2,0).setPos(c)}this.refreshConstraints()};b._reposition=function(){r(this._position.bind(this),0)};b._releaseConstraint=function(){this.constraint&&(this.constraint.release(),this.constraint=null)};a.getInstance=function(b){return a._instances[b]};a.clearAll=function(){for(var b=0;b<a._instances.length;b++)a._instances[b].clear()};return a}();a._activePopover=null;a._MARGIN=40;a._instances={};p(a,["open","close"]);e.exports=a}),null);
__d("MJewelFlyout",["CSS","DOM","EventEmitter","MHistory","MJSEnvironment","MLogState","MTabbable","MViewport","Popover","Stratcom","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";__p&&__p();var r="acw",s="aclb",t=3e3;a=function(){__p&&__p();function a(a,b,c){this.$1=b,this.$2=a,this.$3=c,this.$7=new i()}var b=a.prototype;b.isOpen=function(){return!!this.$9&&this.$9.isOpen()};b.open=function(){this.$9&&this.$9.open()};b.close=function(){this.$9&&this.$9.close()};b.$10=function(){var a=new o({button:h.find(this.$2,"*","icon"),flyout:this.$1,ensureVisible:!1,heightConstraint:!0,preventClose:!0});this.$9=a;this.$4=a.listen("open",this.$11.bind(this));this.$5=a.listen("close",this.$12.bind(this));this.$6=h.listen(this.$1,"click",null,this.$13.bind(this));k.IS_ANDROID&&k.GET_OS_VERSION>=4&&(this.$8=h.scry(this.$1,"div","scroll-area")[0])};b.clear=function(){this.$4&&this.$4.remove(),this.$5&&this.$5.remove(),this.$6&&this.$6.remove(),this.$9&&this.$9.clear()};b.reregisterListeners=function(){var a=this.isOpen();this.clear();this.$10();a&&this.open()};b.addOpenListener=function(a){return this.$7.addListener("open",a)};b.$11=function(){if(this.$8){n.scrollToHeader();var a=document.documentElement;a&&(g.conditionClass(a,"hide-scroll",!0),this.$8.style.maxHeight=a.offsetHeight-200+"px")}j.pushSoftState(this.$3.softState);this.$7.emit("open");p.invoke("m:jewel:flyout:open",this.$3.sigil,{jewel:this.$3.sigil});m.focusTabbable(this.$1)};b.$12=function(){if(this.$8){this.$8.style.minHeight="";var a=document.documentElement;a&&g.conditionClass(a,"hide-scroll",!1)}p.invoke("m:jewel:flyout:close",this.$3.sigil,{jewel:this.$3.sigil});j.popSoftState(this.$3.softState)};b.$13=function(a){l.updateLink(a,this.$3.pos)};b.$14=function(a){a.kill()};b.setHeaderText=function(a,b){if(!a||!b)return;a=h.scry(this.$1,"*",a)[0];if(!a)return;var c=a.cloneNode(!0);c.innerText=b;h.replace(a,c)};a.removeMenuContent=function(a){a=document.getElementById(a);a&&h.remove(a)};a.updateMenuColor=function(b,c,d){d?q(a.$15.bind(this,b,c),t):a.$15(b,c)};a.$15=function(a,b){a=document.getElementById(a);a&&(g.conditionClass(a,s,!b),g.conditionClass(a,r,b))};a.create=function(b,c,d){b=new a(b,c,d);b.$10();return b};return a}();e.exports=a}),null);
__d("MJewel",["CSS","DOM","MJewelFlyout","Stratcom","URI","$","eventsMixinDeprecated","intlNumUtils"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){__p&&__p();var o=0;a=function(){"use strict";__p&&__p();a.create=function(b,c){b=new a(b,c);b._init();return b};function a(b,c){this._count=0,this._sigil=b,this.options=c||{},this._jewelNode=l(a.JEWEL_NAV_NODE_ID),this._softState=c.softState||"jewel="+o++,this._contentsSigil=c.contentsSigil||"contents",this._additionalPaths=c.additionalPaths||[],this._noPopover=!!c.noPopover,this._preventClearBadge=!!c.preventClearBadge,this._count=c.count||0}var b=a.prototype;b._init=function(){if(!this._noPopover){var a=i.create(this._getJewelElement(),this._getFlyoutElement(),{sigil:this._sigil,softState:this._softState,pos:this.options.pos});a.addOpenListener(this.handleViewedContent.bind(this));this._flyout=a}j.listen("m:history:change",null,this._updateJewelsOnHistoryChange.bind(this))};b._updateJewelsOnHistoryChange=function(a){a.getData().soft===this._softState?this._flyout&&this._flyout.open():this._flyout&&this._flyout.close(),this._updateIsJewelActive(a)};b.isInitialized=function(){return!!h.scry(this._jewelNode,"*",this._contentsSigil)[0]};b._getJewelElement=function(){return h.find(this._jewelNode,"div",this._sigil)};b._getCountElement=function(){return h.find(this._getJewelElement(),"span","count")};b._getContentsElement=function(){return h.find(this._getJewelElement(),"*",this._contentsSigil)};b._getFlyoutElement=function(){return h.find(this._getJewelElement(),"*","flyout")};b.getCount=function(){return this._count};b.getFlyout=function(){return this._flyout};b._updateCountElement=function(){var a=this._getJewelCount();h.setContent(this._getCountElement(),n.formatNumberWithThousandDelimiters(a));a=this._getJewelElement();var b=this._count>0;g.conditionClass(a,"noCount",!b);g.conditionClass(a,"hasCount",b)};b._updateIsJewelActive=function(a){var b=new k(a.getData().path);b=b.getPath();a=a.getData().soft;b=!a&&this._additionalPaths.includes(b);a=a===this._softState;g.conditionClass(this._getJewelElement(),"popoverOpen",a||b)};b.setCount=function(a){if(a<0)return;this._count=a;this._updateCountElement()};b.updateCount=function(a,b){!this.isOpen()?this.setCount(a):a&&b()};b.handleViewedContent=function(){this.getCount()>0&&this.isInitialized()?(this._preventClearBadge||this.setCount(0),this.invoke("cleared")):this.invoke("jewel_click")};b._getJewelCount=function(){if(this._count>0)return this._count;else return 0};b.isOpen=function(){return!!this._flyout&&this._flyout.isOpen()};b.reregisterListeners=function(){var a=this._flyout;a&&a.reregisterListeners()};return a}();a.JEWEL_NAV_NODE_ID="mJewelNav";m(a,["cleared","jewel_click"]);e.exports=a}),null);
__d("MJewelLinkFetcher",["DOM","MLinkHack","$"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j="mJewelNav";function a(a){a=g.find(i(j),"div",a);if(!a)return null;a=g.find(a,"a","icon");return!a?null:h.getHref(a)}e.exports={get:a}}),null);
__d("FriendingSurfaceVisitationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var b=a.prototype;b.log=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,g.BASIC)};b.logVital=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,g.VITAL)};b.logImmediately=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,{signal:!0})};b.clear=function(){this.$1={};return this};b.getData=function(){return babelHelpers["extends"]({},this.$1)};b.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};b.setAppVersion=function(a){this.$1.app_version=a;return this};b.setBadgeCount=function(a){this.$1.badge_count=a;return this};b.setClientTimestamp=function(a){this.$1.client_timestamp=a;return this};b.setRawRefTab=function(a){this.$1.raw_ref_tab=a;return this};b.setRawTab=function(a){this.$1.raw_tab=a;return this};b.setRefPage=function(a){this.$1.ref_page=a;return this};b.setSurface=function(a){this.$1.surface=a;return this};b.setTargetProfileID=function(a){this.$1.target_profile_id=a;return this};b.setTime=function(a){this.$1.time=a;return this};b.setVC=function(a){this.$1.vc=a;return this};b.setWeight=function(a){this.$1.weight=a;return this};return a}();b={app_version:!0,badge_count:!0,client_timestamp:!0,raw_ref_tab:!0,raw_tab:!0,ref_page:!0,surface:!0,target_profile_id:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("XFriendRequestIHEventLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/requests/interaction_history_logging/",{target_id:{type:"FBID",required:!0},log_event:{type:"String",required:!0}})}),null);
__d("MFriendRequestIHEventLogger",["DOM","FBJSON","MRequest","XFriendRequestIHEventLoggingController"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();a={listenToProfileClick:function(a,b,c){a=h.parse(a.getAttribute("data-store"));var d=a.userid?a.userid.toString():null;g.listen(c,"click",null,function(){this.logClick(d)}.bind(this));g.listen(b,"click",null,function(){this.logClick(d)}.bind(this))},logImpression:function(a){a&&this._logEvent(a,"impression")},logClick:function(a){a&&this._logEvent(a,"click")},_logEvent:function(a,b){if(isNaN(a))return;a=j.getURIBuilder().setFBID("target_id",a).setString("log_event",b).getURI();new i(a).send()}};e.exports=a}),null);
__d("XExpireFriendRequestsMutationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/requests/expire/",{from_m_jewel:{type:"Bool",defaultValue:!1}})}),null);
__d("MFriendingJewel",["Arbiter","DOM","EventListener","FriendingSurfaceVisitationTypedLogger","MarauderLogger","MFriendRequestIHEventLogger","MJewel","MJewelLinkFetcher","MJewels","MJewelsLogger","MLegacyDataStore","MLogState","MPageCache","MPageFetcher","MPymkFunnelLogger","MRequest","MURI","Popover","Stratcom","XExpireFriendRequestsMutationController","ge","invariant","onAfterDisplay","onAfterTTI","qex","setTimeoutAcrossTransitions","throttle"],(function(a,b,c,d,e,aa,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F){"use strict";__p&&__p();var G="/friends/center/requests/",H="/friends/center/kaios/",I,J,K,L=!1,M=!1,N=!1,O=!1,P=!0,Q=!1,R=!1,S=0;function T(){__p&&__p();I||A(0,2795);f.subscribe("m:jewels:init-counts",ba,"all");I.listen("cleared",V);I.listen("jewel_click",fa);if(O)return;O=!0;x.listen("jewel_requests_add",null,X);x.listen("jewel_requests_remove_old",null,X);x.listen("friend_requests_expired",null,ha);x.listen("jewel_friending_notifs",null,X);x.listen("mobile_requests_count",null,X);x.listen("friend_requests_seen",null,ia);x.listen("m:requests:refresh",null,Y);x.listen("removed_item_hidden_event",null,Y);x.listen("m:jewel:flyout:open",null,ca);x.listen("m:history:change",null,da);K&&h.listen(K,"click",ea)}function ba(a,b){a=b.request_count;if(!I||!a)return;I.reregisterListeners();I.updateCount(a,V);S=a}function ca(a){a=a.getData();if(a.jewel!=="requests")return;new u(y.getURIBuilder().setBool("from_m_jewel",!0).getURI()).send();R&&E(function(){return o.markJewelDisplayed("requests")},1)}function da(a){var b=new v(a.getData().path).normalize().toString();a=a.getData().soft;var c=new v(m.get("requests")).normalize().toString();L&&b!==c?P=!0:!L&&a!=="requests"&&(P=!0)}function ea(){J||A(0,13139),P&&(o.markJewelClick("requests",{isFirstClick:!Q,badgeCount:S,jewelBehavior:L?"permalink":"flyout",isPrefetching:J.shouldPrefetch,initialPrefetchPhase:J.initialPrefetchPhase}),S=0,P=!1),Q=!0}function fa(){I||A(0,2795),ga(),new i().setSurface("jewel").setBadgeCount(I.getCount()).log(),$.lazyLoadRequestsJewelIfTabOpen()}function ga(){__p&&__p();I||A(0,2795);var a=I._getContentsElement();if(!a)return;a=g.scry(a,"div","attachment");var b=[];for(var c=0;c<a.length;c++){var d=a[c].getAttribute("id");d&&d.startsWith("m_jewel_req_")&&(b=b.concat(d.replace("m_jewel_req_","")))}if(b.length){d=new u("/friends/requests/log_impressions");d.setMethod("POST");d.addData({ids:b.join(","),ref:"m_jewel"});d.send()}}function U(){__p&&__p();if(N)return;I||A(0,2795);N=!0;var a=I._getContentsElement();a=g.scry(a,"div","undoable-action");for(var b=0;b<a.length;b++){var c=a[b].getAttribute("data-pymk-id");if(c){var d=a[b].getAttribute("data-signature");t.logImpression(c,d,"mobile_jewel")}else{c=p.get(a[b]).userid;j.log("request_seen","friend_request_waterfall",{request_id:c,request_location:"requests_jewel"});k.logImpression(c?c.toString():null)}}}function V(){x.invoke("m_requests_jewel_mark_read");var a=new u(new v("/a/jewel_requests_read.php").toString());a.send()}function W(){new u("/ajax/mobile/friends/jewel/requests_markup").send()}function X(){if(!I)return;if(I.isOpen())return;W()}function ha(){if(!I)return;W()}function ia(a){if(!I)return;S=0;I.setCount(0)}function Y(){var a=w.getInstance("reqs_flyout");a&&a.refreshConstraints()}function ja(a){var b=function(){Q||Z(!1)};switch(a){case"asap":b();break;case"after-tti":C(b);break;case"after-dd":B(b);break}}var Z=F(function(a){var b=m.get("requests");if(!b)return;a&&r.removeCachedPage(b);s.prefetch(b)},100);function ka(a){if(M){var b=D._("820092");(a||!b)&&Z(!0)}}var $={initJewel:function(a){I=l.create("requests",{pos:q.CLICK_POSITION_REQUESTS_FLYOUT,softState:n.REQUESTS,noPopover:a.shouldRedirectRequestsJewel,additionalPaths:[G,H]}),J=a,L=!!a.shouldRedirectRequestsJewel,K=g.find(z(l.JEWEL_NAV_NODE_ID),"div","requests"),M=a.shouldPrefetch,a.shouldPrefetch&&ja(a.initialPrefetchPhase),T()},lazyLoadRequestsJewelIfTabOpen:function(){if(I&&I.isOpen()){var a=I._getContentsElement();if(x.hasSigil(a,"requests-flyout-pagelet-placeholder"))return;x.hasSigil(a,"requests-flyout-loading")?W():U()}},onAfterUpdateFriendRequests:function(a){if(!I)return;ka(S<a);S=a;!I.isOpen()?I.setCount(a):a&&V();Y();I.isOpen()&&U()},onAfterLoadMoreFriendSuggestions:function(){if(!I)return;Y()},onFlyoutContentDisplayed:function(){if(R)return;R=!0;I&&I.isOpen()&&o.markJewelDisplayed("requests")}};e.exports=$}),null);
__d("MMessagesThreadRowID",[],(function(a,b,c,d,e,f){"use strict";var g="other_user_fbid_",h="thread_fbid_";function a(a,b,c){return a+(b?g+b:h+String(c))}e.exports={getThreadRowID:a}}),null);
__d("MessagingEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DELETE:"delete",DELETE_MESSAGES:"delete_messages",DELIVER:"deliver",ERROR:"error",READ:"read",REPORT_SPAM:"report_spam",REPORT_SPAM_MESSAGES:"report_spam_messages",UNMARK_SPAM:"unmark_spam",SUBSCRIBE:"subscribe",CHANGE_MUTE_SETTINGS:"change_mute_settings",TAG:"tag",UNREAD:"unread",UNSUBSCRIBE:"unsubscribe",DELIVER_LOG:"deliver_log",MARK_ALL_READ:"mark_all_read",MARK_ALL_SEEN:"mark_all_seen",MORE_THREADS:"more_threads",READ_ALL:"read_all",READ_RECEIPT:"read_receipt",DELIVERY_RECEIPT:"delivery_receipt",SENT_PUSH:"sent_push",DELIVER_FAST_PAST:"deliver_fast_path",MESSENGER_STATUS:"messenger_status",UPDATE_PINNED_THREADS:"update_pinned_threads",CHANGE_PAGE_THREAD_FLAG:"change_page_thread_flag",CREATE_PAGE_ADMIN_NOTE:"create_page_admin_note",NO_OP:"no_op"})}),null);
__d("XFBConfirmationCliffTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var b=a.prototype;b.log=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,g.BASIC)};b.logVital=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,g.VITAL)};b.logImmediately=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,{signal:!0})};b.clear=function(){this.$1={};return this};b.getData=function(){return babelHelpers["extends"]({},this.$1)};b.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};b.setCliffCaller=function(a){this.$1.cliff_caller=a;return this};b.setError=function(a){this.$1.error=a;return this};b.setSurface=function(a){this.$1.surface=a;return this};b.setTime=function(a){this.$1.time=a;return this};b.setWeight=function(a){this.$1.weight=a;return this};b.updateExtraData=function(a){a=i(h.serializeMap(a));h.checkExtraDataFieldNames(a,j);this.$1=babelHelpers["extends"]({},this.$1,a);return this};b.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var j={cliff_caller:!0,error:!0,surface:!0,time:!0,weight:!0};e.exports=a}),null);
__d("XMessagesJewelContentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mobile/messages/jewel/content/",{spinner_id:{type:"String",required:!0}})}),null);
__d("MMessagesJewel",["Arbiter","ChannelEventType","DOM","EventListener","MessagingEvent","MJewel","MJewelFlyout","MJewelLinkFetcher","MJewels","MJewelsLogger","MLogState","MMessagesThreadRowID","MPageCache","MPageFetcher","MRequest","MURI","Popover","Stratcom","XFBConfirmationCliffTypedLogger","XMessagesJewelContentController","fbt","ge","invariant","onAfterDisplay","onAfterTTI","qex","setTimeoutAcrossTransitions","throttle"],(function(a,b,c,aa,d,ba,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F){"use strict";__p&&__p();var G="mJewelMsgThreadContents",H="msg_",I,J,K=!1,L=!1,M=null,N,O=!1,P=!0,Q=!1,R=0,S=!1;function T(){I||A(0,2795),e.subscribe("m:jewels:init-counts",da,"all"),I.listen("cleared",V),O||(O=!0,v.listen(f.MESSAGE,null,ga),v.listen(f.MESSAGE,null,fa),v.listen("m:jewel:flyout:open",null,ea),v.listen("m:history:change",null,U),J&&h.listen(J,"click",ca))}function U(a){var b=new t(a.getData().path).normalize().toString();a=a.getData().soft;var c=new t(l.get("messages")).normalize().toString();K&&b!==c?P=!0:!K&&a!=="messages"&&(P=!0)}function ca(){P&&(n.markJewelClick("messages",{isFirstClick:!Q,badgeCount:R,jewelBehavior:K?"permalink":"flyout",isPrefetching:L,initialPrefetchPhase:M}),R=0,P=!1,K&&I&&I.getCount()>0&&(I&&I.setCount(0))),Q=!0}function da(a,b){__p&&__p();a=b.viewer_id;var c=b.unseen_thread_ids;b=b.unread_thread_ids;a&&($.viewerID=a);c&&($.unseenThreadIDs=c.reduce(function(a,b){a[b]=1;return a},{}));b&&($.unreadThreadIDs=b.reduce(function(a,b){a[b]=1;return a},{}));c&&I&&(I.reregisterListeners(),R=c.length,I.updateCount(c.length,V))}function ea(a){a=a.getData();if(!I||a.jewel!=="messages")return;$.messengerCliff&&new w().setSurface("messenger_seen").log();a=I.getCount();I.setCount(a);X();S&&E(function(){return n.markJewelDisplayed("messages")},1)}function V(){var a=new s(new t("/a/jewel_messages_read.php").toString());a.send()}function fa(a){__p&&__p();a=a.getData();if(!a||!I)return;if(a.event===i.READ&&a.message.folder==="inbox"){var b=a.message.thread_fbid||a.message.other_user_fbid;delete $.unseenThreadIDs[b];delete $.unreadThreadIDs[b]}else if(a.event===i.UNREAD&&a.message.folder==="inbox"){b=a.message.thread_fbid||a.message.other_user_fbid;$.unreadThreadIDs[b]=1}else if(a.event===i.MARK_ALL_READ&&a.message.folder==="inbox")$.unreadThreadIDs={},$.unseenThreadIDs={};else if(a.event===i.MARK_ALL_SEEN&&a.message.folder==="inbox")$.unseenThreadIDs={};else if(a.parsedPayload&&a.folder==="inbox"){b=a.parsedPayload;if(!W($.viewerID,b)||b.isUnread()===!1||a.message.is_muted)return;a=b.getThreadFBID()||b.getOtherUserFBID();$.unseenThreadIDs[a]=1;$.unreadThreadIDs[a]=1}else return;b=Object.keys($.unseenThreadIDs).length;a=Object.keys($.unreadThreadIDs).length;var c=R;!I.isOpen()&&b!==I.getCount()&&(R=b,I.setCount(b));b=a>0?y._("Messages ({unread_message_count})",[y._param("unread_message_count",a)]):y._("Messages");a=I.getFlyout();a&&a.setHeaderText("messages_jewel_header_text",b.toString());ia(c<R)}function W(a,b){if(!b.getParticipantIDs())return!1;if(b.getParticipantIDs().indexOf(a)>-1)return!0;if(a)return b.getParticipantIDs().indexOf(a.toString())>-1;else return!1}function X(){I||A(0,2795);var a="messages-flyout-loading";a=g.scry(J,"*",a);if(a.length>0){a=x.getURIBuilder().setString("spinner_id",a[0].getAttribute("id")).getURI();N||(N=new s(a),N.listen("finally",function(){N=null}),N.send())}}function ga(a){__p&&__p();a=a.getData();if(!a||!I)return;if(a.parsedPayload){var b=a.parsedPayload;if(!b.getFolder||b.getFolder()!=="inbox"||!W($.viewerID,b))return;I.isInitialized()&&(k.removeMenuContent(Y(b.getOtherUserFBID(),b.getThreadFBID())),I.isOpen()&&V());K||X()}else a.event===i.READ&&a.is_sync&&k.updateMenuColor(Y(a.message.other_user_fbid,a.message.thread_fbid),!0,!1)}function Y(a,b){return p.getThreadRowID(H,a,b)}function ha(a){var b=function(){Q||Z(!1)};switch(a){case"asap":b();break;case"after-tti":C(b);break;case"after-dd":B(b);break}}var Z=F(function(a){var b=l.get("messages");if(!b)return;a&&q.removeCachedPage(b);r.prefetch(b)},100);function ia(a){if(L){var b=D._("820092");(a||!b)&&Z(!0)}}var $={unseenThreadIDs:{},unreadThreadIDs:{},viewerID:null,messengerCliff:!1,initJewel:function(a){K=!!a.noFlyout,I=j.create("messages",{contentsSigil:G,pos:o.CLICK_POSITION_MESSAGES_FLYOUT,softState:m.MESSAGES,noPopover:K,additionalPaths:["/messages/"]}),J=g.find(z(j.JEWEL_NAV_NODE_ID),"div","messages"),L=!!a.shouldPrefetch,M=a.initialPrefetchPhase,a.shouldPrefetch&&ha(a.initialPrefetchPhase),T()},setMessengerCliff:function(a,b,c){$.messengerCliff=a},refreshMessagesConstraints:function(){u.getInstance("messages_flyout").refreshConstraints()},onFlyoutContentDisplayed:function(){if(S)return;S=!0;I&&I.isOpen()&&n.markJewelDisplayed("messages")}};d.exports=$}),null);
__d("formatNumber",["fbt","intlNumUtils"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();function a(a,b){return h.formatNumber(a,b)}function i(a,b){b=g._({"*":"{number}+"},[g._param("number",h.formatNumberWithThousandDelimiters(a,b),[0,a])]);return b.toString()}function j(a,b){b=g._({"*":"\u003C{number}"},[g._param("number",h.formatNumberWithThousandDelimiters(a,b),[0,a])]);return b.toString()}function b(a,b,c){return a>b?i(b,c):h.formatNumberWithThousandDelimiters(a,c)}function c(a,b,c){return a<b?j(b,c):h.formatNumberWithThousandDelimiters(a,c)}a.withThousandDelimiters=h.formatNumberWithThousandDelimiters;a.withMaxLimit=b;a.withMinLimit=c;e.exports=a}),null);