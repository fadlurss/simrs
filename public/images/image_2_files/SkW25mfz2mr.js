if (self.CavalryLogger) { CavalryLogger.start_js(["pT\/qB"]); }

__d("ChatProxyConnectionState",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.auxiliaryIrisQueues={},this.aiq=null}var b=a.prototype;b.subscribeIrisQueue=function(a,b){this.auxiliaryIrisQueues[a]=b,this.updateCaches()};b.unsubscribeIrisQueue=function(a){delete this.auxiliaryIrisQueues[a],this.updateCaches()};b.updateCaches=function(){var a=[];for(var b in this.auxiliaryIrisQueues)Object.prototype.hasOwnProperty.call(this.auxiliaryIrisQueues,b)&&(a.push(b),a.push(this.auxiliaryIrisQueues[b]));a.length===0?this.aiq=null:this.aiq=a.join(",")};return a}();e.exports=a}),null);
__d("ChannelDefaults",[],(function(a,b,c,d,e,f){e.exports={LONGPOLL_TIMEOUT:6e4,STALL_THRESHOLD:18e4,MIN_RETRY_INTERVAL:5e3,MAX_RETRY_INTERVAL:3e4}}),null);
__d("ChannelEventEmitter",["EventEmitter"],(function(a,b,c,d,e,f,g){"use strict";a=new g();e.exports=a}),null);
__d("ChannelStateMap",[],(function(a,b,c,d,e,f){e.exports={pull:{ok:"pull!",error:"pull",error_missing:"pull",error_msg_type:"pull",clock_anomaly:"pull!",visible:"pull!",hidden:"idle!",refresh_0:"reconnect",refresh_110:"reconnect!",refresh_111:"reconnect",refresh_112:"pull",refresh_113:"pull",refresh_117:"reconnect"},reconnect:{ok:"pull!",error:"reconnect",clock_anomaly:"reconnect!",visible:"pull!",hidden:"idle!"},idle:{ok:"idle!",clock_anomaly:"idle!",visible:"pull!",hidden:"idle!"},shutdown:{clock_anomaly:"shutdown!",visible:"shutdown!",hidden:"shutdown!"}}}),null);
__d("XHRHttpError",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="HTTP_CLIENT_ERROR",h="HTTP_PROXY_ERROR",i="HTTP_SERVER_ERROR",j="HTTP_TRANSPORT_ERROR",k="HTTP_UNKNOWN_ERROR";a={HTTP_CLIENT_ERROR:g,HTTP_PROXY_ERROR:h,HTTP_SERVER_ERROR:i,HTTP_TRANSPORT_ERROR:j,HTTP_UNKNOWN_ERROR:k,getErrorCode:function(a,b){__p&&__p();if(b===0){a=a.getProtocol();return a==="file"||a==="ftp"?null:j}else if(b>=100&&b<200)return h;else if(b>=200&&b<300)return null;else if(b>=400&&b<500)return g;else if(b>=500&&b<600)return i;else if(b>=12001&&b<12156)return j;else return k}};e.exports=a}),null);
__d("xhrSimpleDataSerializer",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}e.exports=a}),null);
__d("XHRRequest",["DTSG_ASYNC","DTSGUtils","Env","ErrorUtils","ResourceTimingsStore","ResourceTypes","SprinkleConfig","TimeSlice","URI","XHRHttpError","ZeroRewrites","getAsyncHeaders","ifRequired","invariant","xhrSimpleDataSerializer"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){__p&&__p();var v={loadedBytes:null,totalBytes:null};a=function(){"use strict";__p&&__p();function a(a){this.setURI(a),this.setResponseType(null),this.setMethod("POST"),this.setTransportBuilder(q.getTransportBuilderForURI(this.getURI())),this.setDataSerializer(u),this.$1=k.getUID(l.XHR,a!=null?a.toString():"")}var b=a.prototype;b.setURI=function(a){this.$2=q.rewriteURI(new o(a));return this};b.getURI=function(){return this.$2};b.setResponseType=function(a){this.$3=a;return this};b.setMethod=function(a){this.$4=a;return this};b.getMethod=function(){return this.$4};b.setData=function(a){this.$5=a;return this};b.getData=function(){return this.$5};b.setRawData=function(a){this.$6=a;return this};b.setRequestHeader=function(a,b){this.$7||(this.$7={});this.$7[a]=b;return this};b.setTimeout=function(a){this.$8=a;return this};b.getTimeout=function(){return this.$8};b.setResponseHandler=function(a){this.$9=a;return this};b.getResponseHandler=function(){return this.$9};b.setErrorHandler=function(a){this.$10=a;return this};b.getErrorHandler=function(){return this.$10};b.setNetworkFailureHandler=function(a){this.$11=a;return this};b.getNetworkFailureHandler=function(){return this.$11};b.getResponseHeader=function(a){return this.$12.getResponseHeader(a)};b.setAbortHandler=function(a){this.$13=a;return this};b.getAbortHandler=function(){return this.$13};b.setTimeoutHandler=function(a){this.$14=a;return this};b.getTimeoutHandler=function(){return this.$14};b.setUploadProgressHandler=function(a){this.$15=a;return this};b.setDownloadProgressHandler=function(a){this.$16=a;return this};b.setTransportBuilder=function(a){this.$17=a;return this};b.setDataSerializer=function(a){this.$18=a;return this};b.send=function(){__p&&__p();var a=this.$8,b=this.$17(),c=this.getURI(),d=new o(c).getQualifiedURI().toString(),e=this.$1;k.updateURI(l.XHR,e,d);k.measureRequestSent(l.XHR,e);this.$12=b;this.$4==="POST"||!this.$6||t(0,2346,this.$6,c);i.force_param&&(this.$5=babelHelpers["extends"]({},this.getData()||{},i.force_param));if(this.$4==="GET"&&h.shouldAppendToken(c)){d=g.getCachedToken?g.getCachedToken():g.getToken();d&&(this.$5?this.$5.fb_dtsg_ag=d:this.$5={fb_dtsg_ag:d},m.param_name&&(this.$5[m.param_name]=h.getNumericValue(d)))}this.$4==="GET"||this.$6?(c.addQueryData(this.$5),d=this.$6):d=this.$18(this.$5);function f(a){k.measureResponseReceived(l.XHR,e);for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];a.apply(this,c)}var j=n.guard(s("JSTracing",function(a){return a.wrap(f)},function(){return f}),"XHRRequest response received",{propagationType:n.PropagationType.CONTINUATION});b.onreadystatechange=this.$19(j);b.onerror=this.$20(j);b.upload&&this.$15&&(b.upload.onprogress=this.$21.bind(this));this.$16&&(b.onprogress=this.$22.bind(this));a&&(this.$23=setTimeout(this.$24.bind(this),a));this.$25!==null&&this.$25!==void 0&&(b.withCredentials=this.$25);b.open(this.$4,c.toString(),!0);j=!1;if(this.$7)for(var p in this.$7)p.toLowerCase()==="content-type"&&(j=!0),b.setRequestHeader(p,this.$7[p]);this.$4=="POST"&&!this.$6&&!j&&b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var q=r(c);Object.keys(q).forEach(function(a){b.setRequestHeader(a,q[a])});this.$3==="arraybuffer"&&("responseType"in b?b.responseType="arraybuffer":"overrideMimeType"in b?b.overrideMimeType("text/plain; charset=x-user-defined"):"setRequestHeader"in b&&b.setRequestHeader("Accept-Charset","x-user-defined"));this.$3==="blob"&&(b.responseType=this.$3);b.send(d)};b.abort=function(a){this.$26(),this.$13&&j.applyWithGuard(this.$13,null,[a],null,"XHRRequest:_abortHandler")};b.$26=function(){var a=this.$12;a&&(a.onreadystatechange=null,a.abort());this.$27()};b.$24=function(){this.$26(),this.$14&&j.applyWithGuard(this.$14,null,null,null,"XHRRequest:_abortHandler")};b.$28=function(a){if(this.$3)if("response"in a)return a.response;else if(this.$3==="arraybuffer"&&window.VBArray)return window.VBArray(a.responseBody).toArray();return a.responseText};b.$20=function(a){var b=this,c=this.$12;return function(){var d={errorCode:p.HTTP_TRANSPORT_ERROR,errorMsg:"Network Failure.",errorType:"Network",errorRawResponseHeaders:null,errorRawTransport:c.constructor&&c.constructor.name,errorRawTransportStatus:0};b.$11?j.applyWithGuard(a.bind(void 0,b.$11),null,[d],null,"XHRRequest:_networkFailureHandler"):a(function(){})}};b.$19=function(a){__p&&__p();var b=this,c=n.guard(function(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return a.apply(this,c)},"XHRRequest onreadystatechange",{propagationType:n.PropagationType.EXECUTION});return function(){__p&&__p();var d=b.$12,e=d.readyState;if(e>=2){var f=e===4,g=b.getURI();g=p.getErrorCode(g,d.status);var h=b.$9;if(g!==null){if(f){g={errorCode:g,errorMsg:b.$28(d),errorRawTransport:d.constructor.name,errorRawTransportStatus:d.status,errorRawResponseHeaders:h&&h.includeHeaders?d.getAllResponseHeaders():null,errorType:d.status?"HTTP "+d.status:"HTTP"};b.$10?j.applyWithGuard(a.bind(void 0,b.$10),null,[g],null,"XHRRequest:_errorHandler"):a(function(){})}}else if(h){g=null;h.includeHeaders&&(g=d.getAllResponseHeaders());if(f||h.parseStreaming&&e===3){e=f?a:c;j.applyWithGuard(e.bind(void 0,h),null,[b.$28(d),g,f],null,"XHRRequest:handler")}}else f&&a(function(){});f&&b.$27()}}};b.$21=function(a){v.loadedBytes=a.loaded,v.totalBytes=a.total,this.$15&&j.applyWithGuard(this.$15,null,[v],null,"XHRRequest:_uploadProgressHandler")};b.$22=function(a){a={loadedBytes:a.loaded,totalBytes:a.total};this.$16&&j.applyWithGuard(this.$16,null,[a],null,"XHRRequest:_downloadProgressHandler")};b.$27=function(){clearTimeout(this.$23),delete this.$12};return a}();e.exports=a}),null);
__d("RTISession",["ErrorUtils","PHPQuerySerializer","URI","XHRRequest","getCrossOriginTransport","invariant"],(function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";__p&&__p();var m=".facebook.com";a=function(){__p&&__p();function a(a,b,c,d,e,f,g,h,i){a||l(0,2469),d||l(0,2470),e||l(0,2471),this.domain=a,this.port=b,this.edgePoolName=c,this.stickyToken=d,this.loggedInId=e,this.accountId=f,this.clientProfile=g||"desktop",this.clientId=h,this.capabilities=i}var b=a.prototype;b.issueRequest=function(a,b,c,d,e){__p&&__p();var f=this;a||l(0,2472);b||l(0,2473);d||l(0,2474);var n=this.domain.length-m.length;n=n>0&&this.domain.indexOf(m,n)!==-1;n=n?this.domain:this.domain+m;var o=(1048576*Math.random()|0).toString(36);o={cb:o,sticky_token:this.stickyToken,uid:this.loggedInId,viewer_uid:this.accountId,sticky_pool:this.edgePoolName,profile:this.clientProfile,clientid:this.clientId,cap:this.capabilities};for(var p in o)b[p]&&l(0,1632);Object.assign(o,b);b=new i(a).setDomain(n).setPort(this.port).setSecure(new i(window.location.href).isSecure()).setQueryData(o);a=c?"POST":"GET";var q={};new j(b).setTransportBuilder(k.withCredentials).setTimeout(e?e*1e3:3e4).setMethod(a).setDataSerializer(function(a){return h.serialize(JSON.stringify(a))}).setData(c).setRequestHeader("Content-Type","application/x-www-form-urlencoded").setResponseHandler(function(a){a=a.substring("for (;;);".length);q.data=JSON.parse(a);q.error=null;g.applyWithGuard(d,f,[q])}).setErrorHandler(function(a){q.data=null,q.error=a.errorMsg||"error",g.applyWithGuard(d,f,[q])}).send()};return a}();e.exports=a}),null);
__d("StateMachine",["EventEmitter","ex","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=0,k=function(){"use strict";__p&&__p();function a(a,b){this.idx=j++,this.machine=a,this.asap=b&&b.substr(-1)=="!",this.name=this.asap?b.substr(0,b.length-1):b,this.progress=m.NEW,this.status=null}var b=a.prototype;b.enter=function(){this.machine.enter_private(this)};b.exit=function(a){this.machine.exit_private(this,a)};b.toString=function(){return this.name+"("+this.progress+","+this.status+")"};return a}(),l="_ABORT_",m=function(b){"use strict";__p&&__p();babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this)||this;d.$StateMachine1=a;d.$StateMachine2=c;d.$StateMachine3=0;d.$StateMachine4=[];d.$StateMachine5=Date.now();return d}var c=a.prototype;c.$StateMachine6=function(a){this.$StateMachine4.push(Date.now()-this.$StateMachine5+": "+a),this.$StateMachine4.length>40&&(this.$StateMachine4=this.$StateMachine4.splice(-20))};c.getState=function(){return this.$StateMachine7};c.setDelay=function(a){this.$StateMachine3=a||0;return this};c.getDelay=function(){return this.$StateMachine3};c.enter=function(a){this.enter_private(new k(this,a))};c.enter_private=function(b){this.$StateMachine6("enter "+b+", "+this.$StateMachine7),this.$StateMachine7&&this.$StateMachine7!=b&&this.$StateMachine7.exit(l),this.$StateMachine7=b,b.asap?(delete b.asap,this.$StateMachine2.enter&&this.$StateMachine2.enter(b),b.progress=a.ENTERED):(b.progress=a.PENDING,b.asap=!0,b.$StateMachine8=i(function(){b.enter()},this.$StateMachine3)),this.emit(a.ENTER,b)};c.exit=function(a){this.exit_private(this.$StateMachine7,a)};c.exit_private=function(b,c){__p&&__p();this.$StateMachine6("exit "+b+", "+c+", "+this.$StateMachine7);if(!b||b!=this.$StateMachine7)throw new Error(h("Invalid state: %s, history: %s",b,this.$StateMachine4.join("|")));if(b.progress==a.EXITED)return;b.status=c;b.progress=a.EXITED;b.$StateMachine8&&(clearInterval(b.$StateMachine8),b.$StateMachine8=null);this.$StateMachine7=null;b&&this.$StateMachine2.exit&&this.$StateMachine2.exit(b);b.exited=!0;this.emit(a.EXIT,b);if(c!=l){var d=this.$StateMachine1[b.name];if(!d||!d[c])throw new Error(h("No exit for state:%s, status: %s",b.name,c));this.enter(d[c])}};return a}(g);m.ENTER="enter";m.EXIT="exit";m.NEW="new";m.PENDING="pending";m.ENTERED="entered";m.EXITED="exited";e.exports=m}),null);
__d("MChannelManager",["Banzai","ChannelClientConfig","ChannelClientID","ChannelDefaults","ChannelEventEmitter","ChannelEventType","ChannelStateMap","ChatProxyConnectionState","Clock","FBLogger","LogHistory","MRequest","MURI","RTISession","StateMachine","URI","Visibility","gkx","rand32","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){__p&&__p();var A,B="ok",C="error",D=6e4,E=null,F=null,G=null,H=null,I=null,J=-1,K=null,L=0,M=i.getID(),N=!1;i={enter:function(a){__p&&__p();H&&(H.abort(),H=null);switch(a.name){case"pull":if(!F.uri)break;if(F.disabled)break;var b=new v(F.uri),c={channel:F.user_channel,seq:G,clientid:M,profile:"mobile",partition:F.partition,sticky_token:J,msgs_recv:L,qp:"y",cb:y()};J==-1&&F.msgr_region&&(c.msgr_region=F.msgr_region);F.chat_enabled&&(c.state="active");K&&(c.sticky_pool=K);F.uid&&F.viewerUid&&(c.uid=F.uid,c.viewer_uid=F.viewerUid);F.state.aiq&&(c.aiq=F.state.aiq);H=new r(b+"").setCORS(!0).setMethod("GET").setData(c).setRaw(!0);H.listen("open",function(a){a.getTransport().withCredentials=!0});H.listen("done",function(b){R(a,b)});H.listen("error",function(){R(a)});break;case"reconnect":b=new s("/a/channel/reconnect.php");H=new r(b+"").setMethod("GET");H.listen("done",function(b){P(a,b)});H.listen("error",function(b){b.isHandled=!0,P(a)});break;default:}H&&H.send()},exit:function(a){if(a.status==="ok")a.name==="pull"&&A.setDelay(0);else if(!(a.status==null)){a=A.getDelay();a=a>0?a*2:E.MIN_RETRY_INTERVAL;a=Math.min(a,E.MAX_RETRY_INTERVAL);A.setDelay(a)}H&&(H.abort(),H=null)}};function O(){var a=null;N&&F&&F.host&&J&&F.uid&&(a=new t(F.host,null,K,J,F.uid,F.viewerUid,"mobile",M,0));k.emit(l.RTI_SESSION,a)}function b(a){I=a}function P(a,b){!b?(p("FIXME").warn("_onReconnectError: reconnect request error"),a.exit(C)):b.user_channel?(F=b,F.state=new n(),G=F.seq,a.exit(B)):(p("FIXME").warn("_onReconnectError: bad reconnect response - %s",JSON.stringify(b)),a.exit(C))}function Q(){N=!0,O()}function R(a,b){__p&&__p();var c=B;if(!b){a.exit(C);return}switch(b.t){case"refresh":case"refreshDelay":c="refresh_"+(b.reason||0);break;case"fullReload":c=B;b.seq==0&&Q();"ms"in b&&S(b);break;case"continue":break;case"lb":var d=b.lb_info;if(d){J=d.sticky;var e="http://";F.is_secure_uri&&(e="https://");"pool"in d?K=d.pool:(F.uri=e+d.vip+".facebook.com/pull",F.host=d.vip)}else p("FIXME").mustfix("bad lb info from channel proxy");break;case"msg":S(b);break;case"batched":e=b.batches;for(d=0;d<e.length;d++)R(a,e[d]);break;case"heartbeat":break;default:c=C;p("FIXME").warn("_onRequestSuccess: invalid channel response, sending request again.");break}"seq"in b&&(G=b.seq);a.exit(c)}function S(a){__p&&__p();var b=a.seq-a.ms.length;for(var c=0;c<a.ms.length;c++){var d=b+c;L++;if(d>=G){I&&(a.ms[c]=I(a.ms[c]));try{if(a.ms[c].type==="skywalker")k.emit(l.SKYWALKER_MESSAGE,a.ms[c]);else if(a.ms[c].type==="qprimer")Q();else if(a.ms[c].type==="privacy_changed"){if(x("676782")){d=a.ms[c].data;d.visiblity!==void 0&&d.visibility!==null&&(F.chat_enabled=d.visibility)}}else A.emit(A.CHANNEL_MESSAGE,a.ms[c])}catch(a){p("FIXME").warn("_processMessages: failed to emit message")}}}}function c(){__p&&__p();if(!A.xhrEnabled||E)return;E=Object.assign(j,h.config);F=h.info;F.state=new n();G=F.seq;o.addListener(o.ANOMALY,function(){A.exit("clock_anomaly")});w.addListener(w.HIDDEN,function(){A.exit("hidden")});w.addListener(w.VISIBLE,function(){A.exit("visible")});a.onbeforeunload=function(){H&&H.abort()};"sticky_token"in F&&(J=F.sticky_token);T()}function d(a,b){F.state.subscribeIrisQueue(a,b)}function f(a){F.state.subscribeIrisQueue(a)}function T(){A.setDelay(E.MIN_RETRY_INTERVAL),A.enter(F.uri?"pull!":"reconnect!")}A=new u(m,i);A.startChannel=c;A.setTransform=b;A.xhrEnabled=!!a.XMLHttpRequest;A.CHANNEL_MESSAGE="channel_message";A.subscribeIrisQueue=d;A.unsubscribeIrisQueue=f;var U;function V(){A.emit(u.ENTER,{name:"stall",progress:u.ENTERED}),T()}function g(a){q.getInstance("channel").log(a.name,a.status||a.progress),a.name!=="stall"&&(clearTimeout(U),U=z(V,D))}A.addListener(u.ENTER,g);A.addListener(u.EXIT,g);k.addListener(l.GET_RTI_SESSION_REQUEST,O);e.exports=A}),null);
__d("MobileZeroRewriteURL",["BanzaiLogger","MChannelManager"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=null,j=null;function a(a){__p&&__p();if(!a)return;i=a.regex_matcher;j=a.regex_replacer;for(var a=0;a<i.length;a++){var b=i[a];b.indexOf("^")===0&&(b=b.substr(1));b=new RegExp(b,"i");i[a]=b}h.setTransform(k)}function k(a){if(!i)return a;l(a);return a}function l(a){if(!a)return;if(Array.isArray(a))for(var b=0;b<a.length;b++)m(a,b);else for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&m(a,c)}function m(a,b){__p&&__p();var c=a[b],d=typeof c;d==="object"?l(c):d==="string"&&c.indexOf("<img")>=0&&(c=c.replace(/<img[^>]*>/gi,function(a){for(var b=0;b<i.length;b++){var c=i[b],d=j[b],e=a.replace(c,d);if(c.test(a)){g.log("ZeroImgRewriteLoggerConfig",{matcher:c,replacer:d,rewrite_url:e,url:a});return e}}return a}),a[b]=c)}f.main=a}),null);
__d("Deferred",["Promise"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();g.resolve();a=function(){__p&&__p();function a(a){var b=this;a=a||g;this.$1=!1;this.$2=new a(function(a,c){b.$3=a,b.$4=c})}var b=a.prototype;b.getPromise=function(){return this.$2};b.resolve=function(a){this.$1=!0,this.$3(a)};b.reject=function(a){this.$1=!0,this.$4(a)};b.isSettled=function(){return this.$1};return a}();e.exports=a}),null);
__d("createChunkedResponseParser",["invariant"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h="\r\n",i=2;function a(a,b){__p&&__p();var c=0,d=function(d,e,f){__p&&__p();b&&(d=b(d),d==null||typeof d==="string"||g(0,4071));if(d){var j=d.length;while(c<j){var k=d.indexOf(h,c);if(k<0)if(f)k=j;else break;k=d.slice(c,k);c+=k.length+i;a(k,e,f&&c>=j)}}else f&&a("",e,!0)};d.parseStreaming=!0;return d}e.exports=a}),null);