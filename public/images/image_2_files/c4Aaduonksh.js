if (self.CavalryLogger) { CavalryLogger.start_js(["fHANF"]); }

__d("Keyframes",["Promise","Bootloader","NavigationMetrics","XHRRequest","emptyFunction","once","promiseDone"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";__p&&__p();var n="::",o="tti";i.addRetroactiveListener(i.Events.EVENT_OCCURRED,function(a,b){a=b.event;o=a});function p(){return new g(function(a){h.loadModules(["KeyframesRenderer"],function(b){return a(b)},"Keyframes")})}function q(){return new g(function(a){h.loadModules(["FBKeyframesLoggedSession"],function(b){return a(b)},"Keyframes")})}function r(){return new g(function(a){h.loadModules(["KeyframesAssetDecoder"],function(b){return a(b)},"Keyframes")})}function s(){return g.all([q(),r(),p()]).then(k)}function t(a){return!a||typeof a!=="string"?g.reject("Request: invalid uri "+a):new g(function(b,c){new j(a).setMethod("GET").setResponseType("arraybuffer").setErrorHandler(function(a){return c(a)}).setAbortHandler(function(a){return c(a)}).setResponseHandler(function(a){return b(a)}).send()})}var u=function(){__p&&__p();function a(b){var c=this;this.$3=function(){var b=a.timestamp();m(c.$1,function(a){return a.error(b)})};this.$1=q().then(function(a){return new a(b)});this.$2=this.$1.then(function(a){return a.getPerformanceLogIfEnabled()})}a.timestamp=function(){return{value:Date.now(),phase:o}};var b=a.prototype;b.scheduleDecode=function(b,c){__p&&__p();var d=b.then(function(){return a.timestamp()}),e=b.then(function(){return c}).then(function(){return a.timestamp()}),f=c.then(function(a){return a&&a.pluginsLoader&&a.pluginsLoader.getPluginTable instanceof Function?a.pluginsLoader.getPluginTable():[]});b=g.all([this.$1,d]).then(function(a){var b=a[0];a=a[1];b=b.startDecode(a);return g.all([b,e,f])});m(b,function(a){var b=a[0],c=a[1];a=a[2];return b(c,a)},this.$3)};b.markAsPackage=function(){m(this.$1,function(a){return a.markAsPackage()})};b.maybeGetPerformanceLog=function(){return this.$2};return a}(),v=function(){__p&&__p();function a(a,b){__p&&__p();var c=this;this.$2=!1;a=g.all([t(a),r()]);this.$1=a.then(function(a){var b=a[0];a=a[1];return a.getDocumentByteSlicesFromPackage(b).then(function(a){return a.map(function(a,b){return l(function(b){return new w(a,b)})})})});b=new u({projectName:b.projectName,assetName:b.packageName});b.markAsPackage();b.scheduleDecode(a,this.$1);m(this.$1,function(){return c.$2=!0},function(){return c.$2=!0})}a.getSliceSession=function(a,b){return new u({projectName:a.projectName,assetName:a.packageName+n+b})};var b=a.prototype;b.isDone=function(){return this.$2};b.getAllAssets=function(b){return this.$1.then(function(c){return g.all(c.map(function(c,d){return c(a.getSliceSession(b,d)).getAsset()}))})};b.getRendererAtIndex=function(b,c){return this.$1.then(function(d){var e=a.getSliceSession(c,b);return d[b]?d[b](e).getRenderer(e):g.reject("Out of bounds index in package: "+b)})};return a}(),w=function(){__p&&__p();function a(a,b){__p&&__p();var c=this;this.$1=!1;a=g.all([typeof a==="string"?t(a):a,r()]);this.$2=a.then(function(a){var b=a[0];a=a[1];return a.fromDocumentBytes(b)});b.scheduleDecode(a,this.$2);m(this.$2,function(){return c.$1=!0},function(){return c.$1=!0})}var b=a.prototype;b.isDone=function(){return this.$1};b.getAsset=function(){return this.$2};b.getRenderer=function(b){var a=p();return g.all([this.$2,a,b.maybeGetPerformanceLog()]).then(function(a){var b=a[0],c=a[1];a=a[2];return new c(b,a)})};return a}(),x={},y={};a={requestRenderer:function(a,b){b=new u(b);x[a]||(x[a]=new w(a,b));return x[a].getRenderer(b)},preload:function(a,b){if(!x[a]){b=new u(b);x[a]=new w(a,b)}b=s();a=x[a].getAsset();return g.all([b,a]).then(k)},requestRendererFromBytes:function(a,b){b=new u(b);return new w(a,b).getRenderer(b)},requestRendererFromPackage:function(a,b,c){y[a]||(y[a]=new v(a,c));return y[a].getRendererAtIndex(b,c)},preloadPackage:function(a,b){y[a]||(y[a]=new v(a,b));var c=s();a=y[a].getAllAssets(b);return g.all([c,a]).then(k)},hasLoaded:function(a){return!!(x[a]&&x[a].isDone()||y[a]&&y[a].isDone())},clearCache:function(){x={},y={}}};e.exports=a}),null);